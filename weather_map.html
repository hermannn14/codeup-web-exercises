<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Weather Map</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
          integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css' rel='stylesheet'/>


</head>
<body>
<script src="js/keys.js"></script>
<script src="./js/jquery.js"></script>
<script>
    "use strict";
    $(document).ready(function () {


        $.get("https://api.openweathermap.org/data/2.5/onecall?", {
            appid: OpenWeatherAPIKey,
            lat:    29.423017,
            lon:   -98.48527,
            units: "imperial"
        }).done(function (data) {
            $('#card-holder').html('')
            for (let i = 0; i < 5; i++) {
                let day = new Date(data.daily[i].dt * 1000)
                $('#card-holder').append(`<div class="col">
                                       <div class="card border-success mb-3" style="max-width: 18rem;">
                                       <h6 class="card-title">Date: ` + (day.getMonth() + 1) + `/` + day.getDate() + ` </h6>
                                       <div class="card">
                                             <ul class="list-group list-group-flush">
                                                 <li class="list-group-item">Description: ${data.daily[i].weather[0].description}</li>
                                                 <li class="list-group-item">Humidity: ${data.daily[i].humidity}</li>
                                                 <li class="list-group-item">Wind: ${data.daily[i].wind_speed}</li>
                                                 <li class="list-group-item">Pressure: ${data.daily[i].temp.max} / ${data.daily[i].temp.min} </li>
                                             </ul>
                                        </div>`)

            }
        })

    })

</script>
<main>
    <nav class="navbar navbar-light bg-primary">
        <span class="navbar-brand mb-0 h1">WeatherMap</span>
        <span class="navbar-brand mb-0 h1">Current City:<p id="anyCity">Los Angeles</p></span>

    </nav>
    <br>
    <form class="form-inline">
        <h6> Place</h6><br>
        <input id="cityAngel" class="form-control mr-sm-2" type="text" placeholder="Los Angeles, CA" aria-label="Search">
        <button id="buttonAngel" class="btn btn-outline-success my-2 my-sm-0 bg-primary" type="button">Find</button>
    </form>
    <br>
    <div class="container">
    <div id="card-holder" class="row">
        <div class="col">
        <div class="card border-success mb-3" style="max-width: 18rem;">
            <h6 class="card-title">Date:</h6>
            <div class="card">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">Description</li>
                    <li class="list-group-item">Humidity</li>
                    <li class="list-group-item">Wind</li>
                    <li class="list-group-item">Pressure</li>
                </ul>
            </div>
            </div>
        </div>
        <div class="col">
        <div class="card border-success mb-3" style="max-width: 18rem;">
            <h6 class="card-title">Date:</h6>
            <div class="card">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">Description</li>
                    <li class="list-group-item">Humidity</li>
                    <li class="list-group-item">Wind</li>
                    <li class="list-group-item">Pressure</li>
                </ul>
            </div>
        </div>
        </div>
        <div class="col">
        <div class="card border-success mb-3" style="max-width: 18rem;">
            <h6 class="card-title">Date:</h6>
            <div class="card">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">Description</li>
                    <li class="list-group-item">Humidity</li>
                    <li class="list-group-item">Wind</li>
                    <li class="list-group-item">Pressure</li>
                </ul>
            </div>
        </div>
        </div>
        <div class="col">
        <div class="card border-success mb-3" style="max-width: 18rem;">
            <h6 class="card-title">Date:</h6>
            <div class="card">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">Description</li>
                    <li class="list-group-item">Humidity</li>
                    <li class="list-group-item">Wind</li>
                    <li class="list-group-item">Pressure</li>
                </ul>
            </div>
        </div>
        </div>
        <div class="col">
        <div class="card border-success mb-3" style="max-width: 18rem;">
            <h6 class="card-title">Date:</h6>
            <div class="card">
                <ul class="list-group list-group-flush">
                    <li class="list-group-item">Description</li>
                    <li class="list-group-item">Humidity</li>
                    <li class="list-group-item">Wind</li>
                    <li class="list-group-item">Pressure</li>
                </ul>
            </div>
        </div>
        </div>
    </div>
    </div>
</main>
<div id='map' style='width: 90vw; height: 90vw;'></div>

<script>
    mapboxgl.accessToken = MAPBOX_KEY;
    let map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v9',
        zoom: 15,
        center: [-118.243683, 34.052235]

    });
    function geocode(search, token) {
        var baseUrl = 'https://api.mapbox.com';
        var endPoint = '/geocoding/v5/mapbox.places/';
        return fetch(baseUrl + endPoint + encodeURIComponent(search) + '.json' + "?" + 'access_token=' + token)
            .then(function(res) {
                return res.json();
                // to get all the data from the request, comment out the following three lines...
            }).then(function(data) {
                return data.features[0].center;
            });
    }

    var anyCity = ""

    $('#buttonAngel').click(function () {
        anyCity = (document.getElementById('cityAngel').value)
        $('#anyCity').html(anyCity)
    geocode(document.getElementById("cityAngel").value, MAPBOX_KEY).then(function (value) {
        map.flyTo({
            center: [
                value[0],
                value[1]
            ],
            essential: true //Reduced motion animation
        })

    })

    })

</script>

</body>
</html>

